<div ng-controller="AzureLogger.ViewLogController" ng-init="init()">

    <div class="umb-panel-header">
        <div class="umb-headline-editor-wrapper">
            <h1 class="headline">{{searchItem.name}}</h1>
        </div>

        <p>searchItem: {{searchItem}}</p>

        <!--<p>Start Date Time : <input type="text" /></p>-->

        <!--item-count: {{ logItems.length }}-->
        <!--detail-count: {{ detailCount }}-->
    </div>

    <div class="umb-panel-body umb-scrollable">
        <div class="umb-pane" ng-if="connected && searchItem" lazy-load="getMoreLogItems()">


        <pre style="float:right">searchItems: {{searchItems|json}}</pre>

            <div class="level-{{logItem.level.toLowerCase()}}" ng-repeat="logItem in logItems">

                <div class="day-breaker" ng-if="differentDays(logItem, logItems[$index - 1])">
                    <h3>{{logItem.eventTimestamp| date : 'EEEE dd MMMM yyyy'}}</h3>
                </div>

                <div class="log-item-intro level-key" ng-click="toggleLogItemDetails($event, logItem)">

                    <div class="eventTimestamp">
                        <div class="hms">{{logItem.eventTimestamp| date : 'HH:mm:ss'}}</div>
                        <div class="ms">{{logItem.eventTimestamp| date : '.sss'}}</div>
                    </div>

                    <div>
                        <span class="host-name">{{logItem.hostName}}</span> -
                        <span class="logger-name">{{logItem.loggerName}}</span>
                    </div>
                    <p class="message">{{logItem.messageIntro}}</p>
                </div>

                <div class="log-item-details level-key">
                    <dl>
                        <dt>Event Timestamp</dt>
                        <dd>
                            <!--<a href="javascript:alert('reload log starting at this date - updates inline date filter at top of page')">-->
                            {{logItem.eventTimestamp| date : 'EEE dd MMM yyyy - HH:mm:ss.sss'}}
                            <!--</a>-->
                        </dd>

                        <dt>Log Timestamp</dt>
                        <dd>{{logItem.details.timestamp| date : 'EEE dd MMM yyyy - HH:mm:ss.sss'}}</dd>

                        <dt>Domain</dt>
                        <dd>{{logItem.details.domain}}</dd>

                        <dt>Identity</dt>
                        <dd>{{logItem.details.identity ? logItem.details.identity : 'Unknown'}}</dd>

                        <dt>Level</dt>
                        <dd>
                            <!-- only use link if filter doesn't match this exactly -->
                            <a href="javascript:alert('open left side filter panel and set level')">
                                {{logItem.level}}
                            </a>
                        </dd>

                        <dt>Logger Name</dt>
                        <dd>
                            <!-- only use link if filter doesn't match this exactly -->
                            <a href="javascript:alert('open left side filter panel and set logger name')">
                                {{logItem.loggerName}}
                            </a>
                        </dd>

                        <dt>Message</dt>
                        <dd>{{logItem.details.message}}</dd>

                        <dt>Thread Name</dt>
                        <dd>{{logItem.details.threadName}}</dd>

                        <dt>User Name</dt>
                        <dd>{{logItem.details.userName}}</dd>

                        <dt>Location</dt>
                        <dd>{{logItem.details.location}}</dd>

                        <dt>ProcessId</dt>
                        <dd>{{logItem.details.processId}}</dd>

                        <dt>AppDomainId</dt>
                        <dd>{{logItem.details.appDomainId}}</dd>

                        <dt>Host Name</dt>
                        <dd>
                            <!-- only use link if filter doesn't match this exactly -->
                            <a href="javascript:alert('open left side filter pabel and set host name')">
                                {{logItem.hostName}}
                            </a>
                        </dd>

                        <dt>Url</dt>
                        <dd>{{logItem.details.url ? logItem.details.url : 'Unknown'}}</dd>
                    </dl>
                </div><!-- /log-item-details-row -->

            </div><!-- /ng-repeat -->
            <!-- should never see this link, as the auto scrolling will push it further down the page out of sight -->
            <a class="get-more-log-items" ng-show="!currentlyLoading && !finishedLoading" ng-click="getMoreLogItems()">Get More Log Items</a>

            <!-- angular can't handle 10,000s of this data, so reset start time filter (not saveable) -->
            <!--<a ng-show="logItems.length >= logItemLimit">Reset from this log entry event time</a>-->

            <div class="currently-loading" ng-show="currentlyLoading">Currently Loading</div>
            <div class="finished-loading" ng-show="finishedLoading">Finsihed Loading</div>

        </div><!-- /umb-panel-body -->
    </div>
</div>